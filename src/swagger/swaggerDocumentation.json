{
  "openapi": "3.0.2",
  "info": {
    "version": "1.0.0",
    "title": "com3504",
    "description": "User management API",
    "termsOfService": "http://api_url/terms/",
    "contact": {
      "name": "Boxuan Shan, Jingxiang Qi, Ziting Zhao",
      "email": "bshan3@sheffield.ac.uk",
      "url": "https://github.com/ace18zz/COM3504The-Intelligent-Web"
    },
    "license": {
      "name": "Apache 2.0",
      "url": "https://www.apache.org/licenses/LICENSE-2.0.html"
    }
  },
  "servers": [
    {
      "url": "http://localhost:3000/",
      "description": "the only Local server"
    }
  ],
  "paths": {
    
    "/img/all": {
      "get": {
        "tags": [
          "image operations"
        ],
        "description": "get full data in json for all images",
        "operationId": "all img.id",
        "responses": {
          "200": {
            "description": "Correct image id",
            "content": {
              "application/json": {
                "schema": {
                  "type": "array",
                  "items":{
                    "$ref" :"#/components/schemas/ImgObj"
                  }
                }
              }
            }
          },
          "500": {
            "description": "Invalid data",
            "content": {
              "text/plain": {
                "schema": {
                  "$ref": "#/components/schemas/ErrorMsg"
                },
                "example": "Invalid data"
              }
            }
          }
        }
      }
    },
    "/img/meta": {
      "get": {
        "tags": [
          "image operations"
        ],
        "description": "Get metadata and data of an image",
        "operationId": "img.id",
        "responses": {
          "200": {
            "description": "Correct image id",
            "content": {
              "application/json": {
                "schema": {
                  "type": "array",
                  "items":{
                  "$ref": "#/components/schemas/ImgMetaObj"
                  }
                }
              }
            }
          },
          "500": {
            "description": "Invalid data",
            "content": {
              "text/plain": {
                "schema": {
                  "$ref": "#/components/schemas/ErrorMsg"
                },
                "example": "Invalid data"
              }
            }
          }
        }
      }
    },
    "/img/{id}": {
      "get": {
        "tags": [
          "image operations"
        ],
        "description": "Get metadata and data of an image",
        "operationId": "img.id",
        "responses": {
          "200": {
            "description": "Correct image id",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/ImgObj"
                },
                "example": {
                  "code":0,
                  "data":{
                    "id":"605c6c684431fa7cd4b36134",
                    "title":"Untitled",
                    "author":"Jingxinag Qi",
                    "desc":"brown and white house on top of mountain",
                    "data":"data:image/gif;base64,R0lGODlhMwAxAIAAAAAAAP///yH5BAAAAAAALAAAAAAzADEAAAK8jI+pBr0PowytzotTtbm/DTqQ6C3hGXElcraA9jIr66ozVpM3nseUvYP1UEHF0FUUHkNJxhLZfEJNvol06tzwrgdLbXsFZYmSMPnHLB+zNJFbq15+SOf50+6rG7lKOjwV1ibGdhHYRVYVJ9Wnk2HWtLdIWMSH9lfyODZoZTb4xdnpxQSEF9oyOWIqp6gaI9pI1Qo7BijbFZkoaAtEeiiLeKn72xM7vMZofJy8zJys2UxsCT3kO229LH1tXAAAOw=="
                  }
                }
              }
            }
          },
          "500": {
            "description": "Invalid data",
            "content": {
              "text/plain": {
                "schema": {
                  "$ref": "#/components/schemas/ErrorMsg"
                },
                "example": "Invalid data"
              }
            }
          }
        }
      }
    },
    "/img/meta/{id}": {
      "get": {
        "tags": [
          "image operations"
        ],
        "description": "Get metadata and data of an image",
        "operationId": "img.metaid",
        "responses": {
          "200": {
            "description": "Correct image id",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/ImgMetaObj"
                },
                "example": {
                  "code":0,
                  "data":{
                    "id":"605c6c684431fa7cd4b36134",
                    "title":"Untitled",
                    "author":"Jingxinag Qi",
                    "desc":"brown and white house on top of mountain",
                    "data":"data:image/gif;base64,R0lGODlhMwAxAIAAAAAAAP///yH5BAAAAAAALAAAAAAzADEAAAK8jI+pBr0PowytzotTtbm/DTqQ6C3hGXElcraA9jIr66ozVpM3nseUvYP1UEHF0FUUHkNJxhLZfEJNvol06tzwrgdLbXsFZYmSMPnHLB+zNJFbq15+SOf50+6rG7lKOjwV1ibGdhHYRVYVJ9Wnk2HWtLdIWMSH9lfyODZoZTb4xdnpxQSEF9oyOWIqp6gaI9pI1Qo7BijbFZkoaAtEeiiLeKn72xM7vMZofJy8zJys2UxsCT3kO229LH1tXAAAOw=="
                  }
                }
              }
            }
          },
          "500": {
            "description": "Invalid data",
            "content": {
              "text/plain": {
                "schema": {
                  "$ref": "#/components/schemas/ErrorMsg"
                },
                "example": "Invalid data"
              }
            }
          }
        }
      }
    },
    "/img/raw/{id}": {
      "get": {
        "tags": [
          "image operations"
        ],
        "description": "Get an image",
        "operationId": "img.rawid",
        "responses": {
          "200": {
            "description": "Correct image id",
            "content": {
              "image/png": {
                "schema": {
                  "type": "string",
                  "format": "binary"
                }
              }
            }
          },
          "500": {
            "description": "Invalid data",
            "content": {
              "text/plain": {
                "schema": {
                  "$ref": "#/components/schemas/ErrorMsg"
                },
                "example": "Invalid data"
              }
            }
          }
        }
      }
    },
    "/upload": {
      "post": {
        "tags": [
          "upload operations"
        ],
        "description": "Upload an image",
        "operationId": "upload",
        "requestBody": {
          "content": {
            "application/json": {
              "schema": {
                "$ref": "#/components/schemas/uploadReq"
              },
              "example": {
                "title":"Untitled",
                "author":"Harrison Qi",
                "desc":"brown and white house on top of mountain",
                "imgType":"http",
                "data":"https://images.unsplash.com/photo-1614717141454-570d887d7357?ixlib=rb-1.2.1&ixid=MnwxMjA3fDB8MHxwaG90by1wYWdlfHx8fGVufDB8fHx8&auto=format&fit=crop&w=1100&q=80"
              }
            }
          },
          "required": true
        },
        "responses": {
          "200": {
            "description": "Correct upload structure",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/uploadRes"
                },
                "example": {
                  "code":0,
                  "data":{
                    "imgId":"605c6c684431fa7cd4b36134"
                  }
                }
              }
            }
          },
          "500": {
            "description": "Invalid data",
            "content": {
              "text/plain": {
                "schema": {
                  "$ref": "#/components/schemas/ErrorMsg"
                },
                "example": "Error: invali Url"
              }
            }
          }
        }
      }
    },
    "/search": {
      "get": {
          "description": " Search room by auther",
          "parameters": [
              {
                  "name": "authorName",
                  "in": "query",
                  "required": true,
                  "schema": {
                      "type": "string"
                  },
                  "allowEmptyValue": true
              }
          ],
          "operationId": "searchAuthor",
          "responses": {
              "default": {
                  "description": "Correct input of search structure",
                  "content": {
                      "application/json": {
                        "schema": {
                          "type": "array",
                          "items":{
                          "$ref": "#/components/schemas/ImgMetaObj"
                          }

                      }
                  } 
              }
          }
      }
  }
},
    "/join": {
      "get": {
          "description": " get join page for a image",
          "parameters": [
              {
                  "name": "imgId",
                  "in": "path",
                  "required": true,
                  "schema": {
                      "type": "string"
                  }
              },
              {
                  "name": "roomId",
                  "in": "query",
                  "required": false,
                  "schema": {
                      "type": "string"
                  },
                  "allowEmptyValue": true
              }
          ],
          "operationId": "getJoinPage",
          "responses": {
              "default": {
                  "description": "Correct input of join structure",
                  "content": {
                      "text/html": {
                        "schema": {
                          "type": "string"

                      }
                  }
              }
          }
      }
  }
},
"/join/offline": {
  "get": {
    "tags": [
      "offline join operations"
    ],
    "description": "get join page for service worker",
    "operationId": "offline",

    "responses": {
      "200": {
        "description": "Correct input of join structure",
        "content": {
          "text/html": {
            "schema": {
              "$ref": "#/components/schemas/joinType"
            }
          }
        }
      },
      "500": {
        "description": "Missing parameters",
        "content": {
          "application/json": {
            "schema": {
              "$ref": "#/components/schemas/ErrorMsg"
            }
        
            }
          }
        }
      }
    }
  }
},

"components": {
  "schemas": {
    "statusCode": {
      "type": "integer",
      "description": "Internal status code for response, value 0 for no error",
      "example": 0
    },
    "imgId": {
      "type": "string",
      "description": "Image ID",
      "example": "605c6c684431fa7cd4b36134"
    },
    "imgTitle": {
      "type": "string",
      "description": "Image title",
      "example": "Untitled - 1"
    },
    "imgAuthor": {
      "type": "string",
      "description": "Image author",
      "example": "User1"
    },
    "imgDesc": {
      "type": "string",
      "description": "Image description",
      "example": "This is an image"
    },
    "imgData": {
      "type": "string",
      "description": "Data url of an image",
      "example": "data:image/gif;base64,R0lGODlhMwAxAIAAAAAAAP///yH5BAAAAAAALAAAAAAzADEAAAK8jI+pBr0PowytzotTtbm/DTqQ6C3hGXElcraA9jIr66ozVpM3nseUvYP1UEHF0FUUHkNJxhLZfEJNvol06tzwrgdLbXsFZYmSMPnHLB+zNJFbq15+SOf50+6rG7lKOjwV1ibGdhHYRVYVJ9Wnk2HWtLdIWMSH9lfyODZoZTb4xdnpxQSEF9oyOWIqp6gaI9pI1Qo7BijbFZkoaAtEeiiLeKn72xM7vMZofJy8zJys2UxsCT3kO229LH1tXAAAOw=="
    },

    "ImgObj": {
      "type": "object",
      "properties": {
        "id": {
          "$ref": "#/components/schemas/imgId"
        },
        "title": {
          "$ref": "#/components/schemas/imgTitle"
        },
        "author": {
          "$ref": "#/components/schemas/imgAuthor"
        },
        "desc": {
          "$ref": "#/components/schemas/imgDesc"
        }
      }
    },
    "ImgMetaObj": {
      "type": "object",
      "properties": {
        "code":{
          "$ref":"#/components/schemas/statusCode"
        },
        "id": {
          "$ref": "#/components/schemas/imgId"
        },
        "title": {
          "$ref": "#/components/schemas/imgTitle"
        },
        "author": {
          "$ref": "#/components/schemas/imgAuthor"
        },
        "desc": {
          "$ref": "#/components/schemas/imgDesc"
        }
      }
    },

    "ImgMetaRes": {
      "type": "object",
      "properties": {
        "code": {
          "$ref": "#/components/schemas/statusCode"
        },
        "data": {
          "$ref": "#/components/schemas/ImgObj"
        }
      }
    },

    "ImgMetaDataObj": {
      "type": "object",
      "properties": {
        "id": {
          "$ref": "#/components/schemas/imgId"
        },
        "title": {
          "$ref": "#/components/schemas/imgTitle"
        },
        "author": {
          "$ref": "#/components/schemas/imgAuthor"
        },
        "desc": {
          "$ref": "#/components/schemas/imgDesc"
        },
        "data": {
          "$ref": "#/components/schemas/imgDesc"
        }
      }
    },

    "ImgMetaDataRes": {
      "type": "object",
      "properties": {
        "code": {
          "$ref": "#/components/schemas/statusCode"
        },
        "data": {
          "$ref": "#/components/schemas/ImgMetaDataObj"
        }
      }
    },

    "uploadType": {
      "type": "string",
      "description": "Upload method (http|data)",
      "example": "http"
    },

    "uploadImg": {
      "type": "string",
      "description": "Either http url or data url",
      "example": "http"
    },

    "uploadReq": {
      "type": "object",
      "properties":{
        "title": {
          "$ref": "#/components/schemas/imgTitle"
        },
        "author": {
          "$ref": "#/components/schemas/imgAuthor"
        },
        "desc": {
          "$ref": "#/components/schemas/imgDesc"
        },
        "imgType": {
          "$ref": "#/components/schemas/uploadType"
        },
        "img": {
          "$ref": "#/components/schemas/uploadImg"
        }
      }
    },

    "uploadObj": {
      "type": "object",
      "properties": {
        "imgId": {
          "$ref": "#/components/schemas/imgId"
        }
      }
    },

    "uploadRes": {
      "type": "object",
      "properties": {
        "code": {
          "$ref": "#/components/schemas/statusCode"
        },
        "data": {
          "$ref": "#/components/schemas/uploadObj"
        }
      }
    },
    "joinType": {
      "type": "string",
      "description": "join method (http|data)",
      "example": "http"
    },
    "ErrorMsg": {
      "type": "string",
      "description": "Error message",
      "example": "Invalid data!"
    }
  
  }
}
}
