{
  "openapi": "3.0.2",
  "info": {
    "version": "1.0.0",
    "title": "com3504",
    "description": "User management API",
    "termsOfService": "http://api_url/terms/",
    "contact": {
      "name": "Boxuan Shan, Jingxiang Qi, Ziting Zhao",
      "email": "bshan3@sheffield.ac.uk",
      "url": "https://github.com/ace18zz/COM3504The-Intelligent-Web"
    },
    "license": {
      "name": "Apache 2.0",
      "url": "https://www.apache.org/licenses/LICENSE-2.0.html"
    }
  },
  "servers": [
    {
      "url": "http://localhost:3000/",
      "description": "the only Local server"
    }
  ],
  "paths": {
    "/img/{id}": {
      "get": {
        "tags": [
          "image operations"
        ],
        "description": "Get metadata and data of an image",
        "operationId": "img.id",
        "responses": {
          "200": {
            "description": "Correct image id",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/ImgMetaObj"
                },
                "example": {
                  "code":0,
                  "data":{
                    "id":"605c6c684431fa7cd4b36134",
                    "title":"Untitled",
                    "author":"Jingxinag Qi",
                    "desc":"brown and white house on top of mountain",
                    "data":"data:image/gif;base64,R0lGODlhMwAxAIAAAAAAAP///yH5BAAAAAAALAAAAAAzADEAAAK8jI+pBr0PowytzotTtbm/DTqQ6C3hGXElcraA9jIr66ozVpM3nseUvYP1UEHF0FUUHkNJxhLZfEJNvol06tzwrgdLbXsFZYmSMPnHLB+zNJFbq15+SOf50+6rG7lKOjwV1ibGdhHYRVYVJ9Wnk2HWtLdIWMSH9lfyODZoZTb4xdnpxQSEF9oyOWIqp6gaI9pI1Qo7BijbFZkoaAtEeiiLeKn72xM7vMZofJy8zJys2UxsCT3kO229LH1tXAAAOw=="
                  }
                }
              }
            }
          },
          "500": {
            "description": "Invalid data",
            "content": {
              "text/plain": {
                "schema": {
                  "$ref": "#/components/schemas/ErrorMsg"
                },
                "example": "Invalid data"
              }
            }
          }
        }
      }
    },
    "/upload": {
      "post": {
        "tags": [
          "upload operations"
        ],
        "description": "Upload an image",
        "operationId": "upload",
        "requestBody": {
          "content": {
            "application/json": {
              "schema": {
                "$ref": "#/components/schemas/uploadReq"
              },
              "example": {
                "title":"Untitled",
                "author":"Harrison Qi",
                "desc":"brown and white house on top of mountain",
                "imgType":"http",
                "data":"https://images.unsplash.com/photo-1614717141454-570d887d7357?ixlib=rb-1.2.1&ixid=MnwxMjA3fDB8MHxwaG90by1wYWdlfHx8fGVufDB8fHx8&auto=format&fit=crop&w=1100&q=80"
              }
            }
          },
          "required": true
        },
        "responses": {
          "200": {
            "description": "Correct upload structure",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/uploadRes"
                },
                "example": {
                  "code":0,
                  "data":{
                    "imgId":"605c6c684431fa7cd4b36134"
                  }
                }
              }
            }
          },
          "500": {
            "description": "Invalid data",
            "content": {
              "text/plain": {
                "schema": {
                  "$ref": "#/components/schemas/ErrorMsg"
                },
                "example": "Error: invali Url"
              }
            }
          }
        }
      }
    },

    "/childDemo": {
      "post": {
        "tags": [
          "silly operations"
        ],
        "description": "add some pointless information about a child's age and the name of a parent",
        "operationId": "child",
        "requestBody": {
          "content": {
            "application/json": {
              "schema": {
                "$ref": "#/components/schemas/ChildDemo"
              }
            }
          },
          "required": true
        },
        "responses": {
          "200": {
            "description": "Correct input of Child structure",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/ChildDemo"
                }
              }
            }
          },
          "401": {
            "description": "Missing parameters",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/ErrorDemo"
                },
                "example": {
                  "message": "age is not a number",
                  "internal_code": "missing_parameters"
                }
              }
            }
          }
        }
      }
    },
    "/adultDemo": {
         "post": {
           "tags": [
             "silly operations"
           ],
           "description": "add some pointless information about an adult like age, weight and height",
           "operationId": "adult",
           "requestBody": {
             "content": {
               "application/json": {
                 "schema": {
                   "$ref": "#/components/schemas/AdultDemo"
                 }
               }
             },
             "required": true
           },
           "responses": {
             "200": {
               "description": "Correct input of Adult",
               "content": {
                 "application/json": {
                   "schema": {
                     "$ref": "#/components/schemas/AdultDemo"
                   }
                 }
               }
             },
             "401": {
               "description": "Missing parameters",
               "content": {
                 "application/json": {
                   "schema": {
                     "$ref": "#/components/schemas/ErrorDemo"
                   },
                   "example": {
                     "message": "age is not a number",
                     "internal_code": "missing_parameters"
                   }
                 }
               }
             }
           }
         }
       }
  },
  "components": {
      "schemas": {
        "statusCode": {
          "type": "integer",
          "description": "Internal status code for response, value 0 for no error",
          "example": 0
        },
        "imgId": {
          "type": "string",
          "description": "Image ID",
          "example": "605c6c684431fa7cd4b36134"
        },
        "imgTitle": {
          "type": "string",
          "description": "Image title",
          "example": "Untitled - 1"
        },
        "imgAuthor": {
          "type": "string",
          "description": "Image author",
          "example": "User1"
        },
        "imgDesc": {
          "type": "string",
          "description": "Image description",
          "example": "This is an image"
        },
        "imgData": {
          "type": "string",
          "description": "Data url of an image",
          "example": "data:image/gif;base64,R0lGODlhMwAxAIAAAAAAAP///yH5BAAAAAAALAAAAAAzADEAAAK8jI+pBr0PowytzotTtbm/DTqQ6C3hGXElcraA9jIr66ozVpM3nseUvYP1UEHF0FUUHkNJxhLZfEJNvol06tzwrgdLbXsFZYmSMPnHLB+zNJFbq15+SOf50+6rG7lKOjwV1ibGdhHYRVYVJ9Wnk2HWtLdIWMSH9lfyODZoZTb4xdnpxQSEF9oyOWIqp6gaI9pI1Qo7BijbFZkoaAtEeiiLeKn72xM7vMZofJy8zJys2UxsCT3kO229LH1tXAAAOw=="
        },

        "ImgMetaObj": {
          "type": "object",
          "properties": {
            "id": {
              "$ref": "#/components/schemas/imgId"
            },
            "title": {
              "$ref": "#/components/schemas/imgTitle"
            },
            "author": {
              "$ref": "#/components/schemas/imgAuthor"
            },
            "desc": {
              "$ref": "#/components/schemas/imgDesc"
            }
          }
        },

        "ImgMetaRes": {
          "type": "object",
          "properties": {
            "code": {
              "$ref": "#/components/schemas/statusCode"
            },
            "data": {
              "$ref": "#/components/schemas/ImgMetaObj"
            }
          }
        },

        "ImgMetaDataObj": {
          "type": "object",
          "properties": {
            "id": {
              "$ref": "#/components/schemas/imgId"
            },
            "title": {
              "$ref": "#/components/schemas/imgTitle"
            },
            "author": {
              "$ref": "#/components/schemas/imgAuthor"
            },
            "desc": {
              "$ref": "#/components/schemas/imgDesc"
            },
            "data": {
              "$ref": "#/components/schemas/imgDesc"
            }
          }
        },

        "ImgMetaDataRes": {
          "type": "object",
          "properties": {
            "code": {
              "$ref": "#/components/schemas/statusCode"
            },
            "data": {
              "$ref": "#/components/schemas/ImgMetaDataObj"
            }
          }
        },

        "uploadType": {
          "type": "string",
          "description": "Upload method (http|data)",
          "example": "http"
        },

        "uploadImg": {
          "type": "string",
          "description": "Either http url or data url",
          "example": "http"
        },

        "uploadReq": {
          "type": "object",
          "properties":{
            "title": {
              "$ref": "#/components/schemas/imgTitle"
            },
            "author": {
              "$ref": "#/components/schemas/imgAuthor"
            },
            "desc": {
              "$ref": "#/components/schemas/imgDesc"
            },
            "imgType": {
              "$ref": "#/components/schemas/uploadType"
            },
            "img": {
              "$ref": "#/components/schemas/uploadImg"
            }
          }
        },

        "uploadObj": {
          "type": "object",
          "properties": {
            "imgId": {
              "$ref": "#/components/schemas/imgId"
            }
          }
        },

        "uploadRes": {
          "type": "object",
          "properties": {
            "code": {
              "$ref": "#/components/schemas/statusCode"
            },
            "data": {
              "$ref": "#/components/schemas/uploadObj"
            }
          }
        },

        "ErrorMsg": {
          "type": "string",
          "description": "Error message",
          "example": "Invalid data!"
        },



        "ageDemo": {
          "type": "integer",
          "description": "age of a person",
          "example": 9
        },
        "heightDemo": {
          "type": "integer",
          "description": "height in cm",
          "example": 185
        },
        "weightDemo": {
          "type": "integer",
          "description": "weight in kg",
          "example": 65
        },
        "nameDemo": {
          "type": "string",
          "example": "John"
        },
        "surnameDemo": {
          "type": "string",
          "example": "White"
        },
        "AdultDemo": {
          "type": "object",
          "properties": {
            "age": {
              "$ref": "#/components/schemas/ageDemo"
            },
            "height": {
              "$ref": "#/components/schemas/heightDemo"
            },
            "weight": {
              "$ref": "#/components/schemas/weightDemo"
            }
          }
        },
        "ChildDemo": {
          "type": "object",
          "properties": {
            "age": {
              "$ref": "#/components/schemas/ageDemo"
            },
            "parent": {
              "$ref": "#/components/schemas/ParentDemo"
            }
          }
        },
        "ParentDemo": {
          "type": "object",
          "properties": {
            "name": {
              "$ref": "#/components/schemas/nameDemo"
            },
            "surname": {
              "$ref": "#/components/schemas/surnameDemo"
            }
          }
        },
        "ErrorDemo": {
          "type": "object",
          "properties": {
            "message": {
              "type": "string"
            },
            "internal_code": {
              "type": "string"
            }
          }
        }
      }
    }
}
